<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Saeed Sharifi-Malvajerdi, Feiyu Zhu" />

<meta name="date" content="2018-08-27" />

<title>Malaria Parasite Clearance Rate Regression by bhrcr package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Malaria Parasite Clearance Rate Regression by <strong><code>bhrcr</code></strong> package</h1>
<h4 class="author"><em>Saeed Sharifi-Malvajerdi, Feiyu Zhu<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></em></h4>
<h4 class="date"><em>2018-08-27</em></h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#bayesian-hierarchical-regression-on-clearance-rates-model">Bayesian Hierarchical Regression on Clearance Rates: Model</a></li>
<li><a href="#the-pursat-data">The <code>Pursat</code> Data</a></li>
<li><a href="#the-clearanceestimatorbayes-function">The <code>clearanceEstimatorBayes</code> Function</a></li>
<li><a href="#the-summary-and-print-functions">The <code>summary</code> and <code>print</code> Functions</a></li>
<li><a href="#the-diagnostics-function">The <code>diagnostics</code> Function</a></li>
<li><a href="#the-plot-function">The <code>plot</code> Function</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p>This vignette contains a brief description of malaria parasite clearance rate regression and provides a quick tutorial for <strong><code>bhrcr</code></strong> package. For more details, see our paper <strong>“Malaria Parasite Clearance Rate Regression: An R Software Package for a Bayesian Hierarchical Regression Model”</strong> which will appear in the <em>Malaria Journal</em>.</p>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Malaria is a mosquito-borne disease caused by parasites that was estimated to cause 429,000 deaths in 2015 (World Malaria Report, 2016). Resistance to anti-malarial drugs such as Artemisinin is a major concern in the public health fight against malaria <span class="citation">(Ashley <em>et al.</em> <a href="#ref-ashley">2014</a>)</span>. Artemisinin resistance is manifested by delayed parasite clearance after treatment; slower parasite clearance can therefore indicate emergence of parasite resistance, although it can also be associated with host factors such as decreased immunity, inadequate dosing or poor drug absorption. Understanding how covariates relate to parasite clearance rate is important for understanding host and parasite factors’ association with delayed parasite clearance, characterizing resistance and defining spatio-temporal trends in resistance. The parasite clearance rate is defined as the negative of the slope of the log-parasitemia over the time in which the antimalarial is having its primary effect, and we call this time period the “decay” phase. There are some difficulties that arise in calculating the parasite clearance rates. First, some patients’ profiles may contain a “lag” phase, before the decay phase, in which the parasite density remains constant, or even increases, in a period right after artemisinin administration (<span class="citation">Doolan (<a href="#ref-doolan">2002</a>)</span>, <span class="citation">Koning (<a href="#ref-koning">2007</a>)</span>). Second, there might be also a “tail” phase, after the decay phase, where the true parasite count remains close to the detection limit, with no decline over a few measurements, and once the detection limit is reached, observations are left censored. Lastly, there may exist measurement errors in the measured values of parasite densities (see <span class="citation">Dowling and Shute (<a href="#ref-dowling">1966</a>)</span> and <span class="citation">O’Meara <em>et al.</em> (<a href="#ref-omeara">2005</a>)</span> for more details). The Parasite Clearance Estimator (PCE) was developed by the WorldWide Antimalarial Resistance Network (WWARN) in response to the need from field researchers for a method to quickly and reliably estimate parasite clearance rates, while accounting for existence of lag phases, tail phases, and censored observations (<span class="citation">Flegg <em>et al.</em> (<a href="#ref-flegg">2011</a>)</span>).</p>
<p>Although the WWARN PCE serves as a powerful tool for estimating the clearance rates in many studies, estimating the impact of individual level covariates on these clearance rates might be the primary end point in some other studies. For instance, as in <span class="citation">Amaratunga <em>et al.</em> (<a href="#ref-amaratunga">2012</a>)</span>, understanding how parasite factors and host factors influence clearance rates can provide insights into the mechanism of artemisinin resistance. One common approach in estimating the effect of individual level covariates on clearance rates is using a <em>two-stage procedure</em>, where WWARN PCE is followed by a simple linear regression. Even though using the two-stage approach is straightforward, it has some drawbacks which motivated <span class="citation">Fogarty <em>et al.</em> (<a href="#ref-fogarty">2015</a>)</span> to develop the Bayesian Clearance Estimator. This procedure uses a Bayesian hierarchical model to estimate both clearance rates and the impact of patient level covariates on them, while accounting for lag phases, tail phases, and censored observations. Given the advantages of the Bayesian approach over the two-stage analysis, we built the <strong><code>bhrcr</code></strong> package to provide researchers in the related fields with software that performs the Bayesian hierarchical regression on clearance rates. The <strong><code>bhrcr</code></strong> package provides tools (<code>calculatePCE</code> function) to calculate the WWARN PCE estimates of the parasite clearance rates as well.</p>
<p>The <strong><code>bhrcr</code></strong> package takes serial measurements of a response on an individual (e.g., parasite counts after artemisinin administration) that is decaying over time, and performs Bayesian hierarchical regression on the clearance rates. While this tutorial illustrates the method in the context of malaria, the package can be utilized to analyze any clearance data fitting the framework presented in the next section. The <em>Plasmodium falciparum</em> clearance data–previously analyzed by <span class="citation">(Amaratunga <em>et al.</em> <a href="#ref-amaratunga">2012</a>)</span> and <span class="citation">(Fogarty <em>et al.</em> <a href="#ref-fogarty">2015</a>)</span>– is included in this package. We will provide a description of the data shortly. The main function of the <strong><code>bhrcr</code></strong> package is <code>clearanceEstimatorBayes</code>, which will be clarified thoroughly later on. While the <code>clearanceEstimatorBayes</code> function returns the WWARN PCE estimates as well, we have incorporated the <code>calculatePCE</code> function in the package, which only provides the WWARN PCE estimates of the clearance rates. The generic <code>summary</code>, <code>print</code>, and <code>plot</code> functions , as well as the <code>diagnostics</code> function, will be illustrated by examples in following sections.</p>
<p>For a quick demonstration of the package, please run the following functions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bhrcr)
<span class="co"># If you don't bother to see the step-by-step interactive</span>
<span class="co"># process of PCE estimation and generating plots</span>
<span class="co"># please set &quot;ask = F&quot;.</span>
<span class="kw">demo</span>(fastExample, <span class="dt">ask =</span> F)
<span class="co"># or we can run the slowExample.</span>
<span class="co"># to save your time, we have already run the MCMC in the slow example for you.</span>
<span class="co"># the demo will show you the saved results.</span>
<span class="kw">demo</span>(slowExample, <span class="dt">ask =</span> F)</code></pre></div>
</div>
<div id="bayesian-hierarchical-regression-on-clearance-rates-model" class="section level2">
<h2>Bayesian Hierarchical Regression on Clearance Rates: Model</h2>
<p>We now briefly present the Bayesian Clearance Estimator developed in <span class="citation">Fogarty <em>et al.</em> (<a href="#ref-fogarty">2015</a>)</span>. Let <span class="math inline">\(y_{ij}\)</span> represent the <span class="math inline">\(j\)</span>th measurement of patient <span class="math inline">\(i\)</span>’s parasite count at time <span class="math inline">\(t_{ij}\)</span>, where <span class="math inline">\(1 \le i \le N\)</span> and <span class="math inline">\(1 \le j \le n_i\)</span><a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>. Suppose <span class="math inline">\(\delta_{i}^\ell\)</span> is patient <span class="math inline">\(i\)</span>’s time of changepoint between the lag and decay phases, and let <span class="math inline">\(\delta_{i}^\tau\)</span> be patient <span class="math inline">\(i\)</span>’s time of changepoint between decay and tail phases. The observed data are assummed to follow a continuous piecewise linear model<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>: <span class="math display">\[
\log (y_{ij}) = \alpha_i - \beta_i \left(\delta_i ^\ell {\mathbb{1}}_{ t_{ij} &lt; \delta_i ^\ell} + t_{ij} {\mathbb{1}}_{ \delta_i ^\ell \le t_{ij} \le \delta_i ^\tau} + \delta_i ^\tau {\mathbb{1}}_{ t_{ij} &gt; \delta_i ^\tau } \right) + \epsilon_{ij}  \tag{$\dagger$}
\]</span> where <span class="math inline">\(\beta_i\)</span> is the clearance rate of the <span class="math inline">\(i\)</span>th individual, and <span class="math inline">\(\epsilon_{ij} \overset{iid} \sim {\mathcal{N}}(0 , \sigma_\epsilon^2).\)</span><a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a></p>
<p>Within a Bayesian hierarchical structure, the patients, and correspondingly the patients’ parameters such as <span class="math inline">\(\{ \beta_i \}_{i=1}^N\)</span> and <span class="math inline">\(\{ \alpha_i \}_{i=1}^N\)</span>, are assumed to be draws from a common distribution. This hierarchical structure allows us to borrow strength across patients, in the sense that information about all patients informs the regularization of patient-specific parameters. For details on the prior distributions used in this Bayesian framework, see <span class="citation">Fogarty <em>et al.</em> (<a href="#ref-fogarty">2015</a>)</span> and our JSS paper.</p>
</div>
<div id="the-pursat-data" class="section level2">
<h2>The <code>Pursat</code> Data</h2>
<p>The data sets contained in the <strong><code>bhrcr</code></strong> package consist of <em>Plasmodium falciparum</em> clearance profiles of 110 patients, along with individual level covariates, measured in 2009 and 2010 in the Pursat province of Western Cambodia. Parasite densities were measured every 6 hours, and the detection limit was 15 parasites per microliter. Additionally, parasites were divided into two genetically different groups, labeled <em>group 1</em> and <em>group 2</em>. All 110 individuals were observed until no parasites were detected in their blood. The individual level covariates are</p>
<ul>
<li><p>Sex: A factor variable with two levels <code>F</code> and <code>M</code></p></li>
<li><p>Age Group: 21+ (21 years of age or older), or 21- (younger than 21 years)</p></li>
<li><p>Veal Veng or Kranvanh: whether or not an individual was from these two districts</p></li>
<li><p>Hemoglobin E: the number of alleles of Hemoglobin E variant</p></li>
<li><p><span class="math inline">\(\alpha\)</span>-thalassaemia: the number of alleles of <span class="math inline">\(\alpha\)</span>-thalassaemia variant</p></li>
<li><p>G6PD deficient: the number of alleles of G6PD deficient variant</p></li>
<li><p>Log initial parasite density</p></li>
<li><p>Year: <code>TRUE</code> if 2010, <code>FALSE</code> if 2009</p></li>
<li><p>Parasite group: 1 if <em>group 1</em>, 0 if <em>group 2</em></p></li>
</ul>
<p>For more details on the data, see <span class="citation">(Amaratunga <em>et al.</em> <a href="#ref-amaratunga">2012</a>)</span> and <span class="citation">(Fogarty <em>et al.</em> <a href="#ref-fogarty">2015</a>)</span>. One can use <code>data(&quot;pursat&quot;)</code> and <code>data(&quot;pursat_covariates&quot;)</code> to access the data sets.</p>
</div>
<div id="the-clearanceestimatorbayes-function" class="section level2">
<h2>The <code>clearanceEstimatorBayes</code> Function</h2>
<p>The <code>clearanceEstimatorBayes</code> function is the principal function in the <strong><code>bhrcr</code></strong> package that analyzes the input data set in the Bayesian framework presented before, and provides the posterior distributions of the parameters, along with point estimates and credible intervals.</p>
<p>Usage:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out &lt;-<span class="st"> </span><span class="kw">clearanceEstimatorBayes</span>(<span class="dt">data =</span> data, <span class="dt">covariates=</span>covariates,
       <span class="dt">seed=</span><span class="dv">1234</span>, <span class="dt">detect.limit=</span><span class="dv">40</span>, <span class="dt">outlier.detect =</span> <span class="ot">TRUE</span>, <span class="dt">conf.level=</span>.<span class="dv">95</span>,
       <span class="dt">niteration =</span> <span class="dv">100000</span>, <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">thin =</span> <span class="dv">50</span>, 
       <span class="dt">filename =</span> <span class="st">&quot;output.csv&quot;</span>)</code></pre></div>
<p>See the manual page of this function for more information on the arguments and outputs.</p>
</div>
<div id="the-summary-and-print-functions" class="section level2">
<h2>The <code>summary</code> and <code>print</code> Functions</h2>
<p>The <code>summary</code> function produces comprehensive and compressed output information based on the results from the main function, <code>clearanceEstimatorBayes</code>. To further illustrate this point, we use the built-in data sets of <strong><code>bhrcr</code></strong> package, <code>pursat</code> and <code>pursat_covariates</code>, to provide an example.<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bhrcr)
<span class="kw">data</span>(pursat)
<span class="kw">data</span>(pursat_covariates)
results &lt;-<span class="st"> </span><span class="kw">clearanceEstimatorBayes</span>(<span class="dt">data =</span> pursat, 
           <span class="dt">covariates =</span> pursat_covariates, <span class="dt">seed =</span> <span class="dv">1234</span>,
           <span class="dt">detect.limit =</span> <span class="dv">15</span>, <span class="dt">burnin=</span><span class="dv">50</span>, <span class="dt">niteration=</span><span class="dv">100</span>, <span class="dt">thin=</span><span class="dv">10</span>)      
<span class="kw">summary</span>(results)</code></pre></div>
<p>For reproducibility of our results, we may set the <code>seed</code> argument to be <code>1234</code>. The output given by <code>summary</code> includes a table containing posterior mean and median of the regression coefficients which represent the impact of covariates on log parasite clearance rates and also on the corresponding log half-life values. The half-life value is calculated as <span class="math inline">\(\log(2) ~/ \text{ (Clearance Rate) }\)</span>. Thus, even though our method originally regressed log clearance rates rather than log half-lives on the covariates, we can attain the slopes for a regression of the log half-lives by using <span class="math inline">\(\log(\text{Half-Life}) = \log\log(2) - \log(\text{Clearance Rate})\)</span>.</p>
<p>If the input data set does not contain WWARN PCE estimates, the <code>clearanceEstimatorBayes</code> function will automatically generate a folder called <code>PceEstimates</code> under your current working directory to store calculated WWARN PCE estimates for each individual.</p>
<p>In what follows, we display the results in terms of log half-lives which may be more intuitive to the malaria research community. The half-life is the time it takes for the parasite density to reduce by 50%; the longer the half-life, the slower the parasite clearance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Summary:

<span class="kw">clearanceEstimatorBayes</span>(<span class="dt">data =</span> pursat, <span class="dt">covariates =</span> pursat_covariates, 
    <span class="dt">seed =</span> <span class="dv">1234</span>, <span class="dt">detect.limit =</span> <span class="dv">15</span>, <span class="dt">niteration =</span> <span class="dv">100</span>, <span class="dt">burnin =</span> <span class="dv">50</span>, <span class="dt">thin =</span> <span class="dv">10</span>)

Posterior Estimates and Intervals for the Effect of Covariates on log half-lives 

               Mean  Median  CI <span class="fl">2.5</span>% CI 97.5%
(Intercept)   <span class="fl">1.1371</span>  <span class="fl">1.2486</span>  <span class="fl">0.3096</span>   <span class="fl">1.7616</span>
SexM          <span class="fl">0.1648</span>  <span class="fl">0.1508</span>  <span class="fl">0.0755</span>   <span class="fl">0.3060</span>
agegroup21+<span class="st">  </span>-<span class="fl">0.0002</span>  <span class="fl">0.0163</span> -<span class="fl">0.0674</span>   <span class="fl">0.0866</span>
vvkvTRUE     -<span class="fl">0.0227</span> -<span class="fl">0.0295</span> -<span class="fl">0.0985</span>   <span class="fl">0.0567</span>
HbE           <span class="fl">0.0898</span>  <span class="fl">0.0961</span> -<span class="fl">0.0201</span>   <span class="fl">0.2017</span>
athal        -<span class="fl">0.0348</span> -<span class="fl">0.0608</span> -<span class="fl">0.1263</span>   <span class="fl">0.1307</span>
g6pd         -<span class="fl">0.0168</span> -<span class="fl">0.0222</span> -<span class="fl">0.0814</span>   <span class="fl">0.0579</span>
lnPf0         <span class="fl">0.0356</span>  <span class="fl">0.0175</span> -<span class="fl">0.0140</span>   <span class="fl">0.1162</span>
year2010TRUE  <span class="fl">0.0465</span>  <span class="fl">0.0488</span> -<span class="fl">0.0306</span>   <span class="fl">0.1213</span>
group         <span class="fl">0.1532</span>  <span class="fl">0.1522</span>  <span class="fl">0.0734</span>   <span class="fl">0.2418</span>
---
Detect Limit:<span class="st">  </span><span class="dv">15</span> , Log Base:<span class="st">  </span><span class="fl">2.718</span> </code></pre></div>
<p>Based on the output of the <code>summary</code> function, we can perform an analysis of the covariates of interest. For details, please see <span class="citation">(Fogarty <em>et al.</em> <a href="#ref-fogarty">2015</a>)</span> and our JSS paper.</p>
</div>
<div id="the-diagnostics-function" class="section level2">
<h2>The <code>diagnostics</code> Function</h2>
<p>The <code>diagnostics</code> function provides diagnostic analysis such as trace plots, ACF and PACF plots for some important parameters in the MCMC process of Gibbs sampling.<a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a> These diagnostic plots help to assess whether it is plausible that the MCMC process has reached stationarity and that we have thinned sufficiently (see <span class="citation">(Cowles and Carlin <a href="#ref-cowles">1996</a>)</span>; <span class="citation">(Gelman and Shirley <a href="#ref-gelman2011">2011</a>)</span>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We use the results given by our previous example</span>
<span class="co"># All diagnostic plots are saved under &quot;./mcmcDiagnostics&quot;</span>
<span class="kw">diagnostics</span>(results)</code></pre></div>
<p>In our fast example, the burn-in period and the total length of simulation (also referred to as the length of Markov chain) are short, which may not provide enough time for convergence. For serious malaria research, our recommendation is:</p>
<ol style="list-style-type: decimal">
<li><p>detect outliers by using the methodology suggested in <span class="citation">(Flegg <em>et al.</em> <a href="#ref-flegg">2011</a>)</span>. We recommend using Flegg’s outlier detection method which is included in the function <code>outlierDetect</code> in our package. But users can choose to toggle it off by setting <code>outlier.detect = FALSE</code> when they are running the main function <code>clearanceEstimatorBayes</code>. If the outliers are determined to be likely due to transcription errors, then the outlying data points should be deleted;</p></li>
<li><p>run the Gibbs sampling algorithm (already embedded in <code>clearanceEstimatorBayes</code>) from different starting points and observe the trace plots, ACF and PACF plots;</p></li>
<li><p>determine the suitable burn-in period to make sure the final sample is collected after the Markov chain reaches stationarity;</p></li>
<li><p>set a suitable step size in “thinning” to make sure final sample is close to independent if independence is desired (the ACF plot can be used to detect autocorrelation).</p></li>
</ol>
<p>The posterior results produced by our fast example may not be very reliable; we have used the fast sample just for tutorial purposes. For the results of the Bayesian clearance estimator to truly reflect the posterior uncertainty in our estimators, we need to ensure that stationarity has been achieved. Results that satisfy the requisite diagnostics are found in a longer sample (<code>slowExample</code>), which we have saved into a dataset called  and incorporated into the <strong><code>bhrcr</code></strong> package. To see the results, just run the slow example in the demo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">demo</span>(slowExample, <span class="dt">ask =</span> F)</code></pre></div>
<p>For detailed analysis of the diagnostic results, please see our JSS paper.</p>
</div>
<div id="the-plot-function" class="section level2">
<h2>The <code>plot</code> Function</h2>
<p>The <code>plot</code> function visualizes the results returned by the <code>clearanceEstimatorBayes</code> function. We continue our previous example as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># All plots are saved under &quot;./plots&quot;</span>
<span class="kw">plot</span>(results)</code></pre></div>
<p>The output provides a group of figures showing all patients’ posterior log-parasitemia profiles fitted by the Bayesian method. The following figure shows the profile of patient 1. It seems to exhibit only a decay phase.</p>
<embed src="data:application/pdf;base64,JVBERi0xLjQKJYHigeOBz4HTXHIKMSAwIG9iago8PAovQ3JlYXRpb25EYXRlIChEOjIwMTgwMTI2MTQxNDQ1KQovTW9kRGF0ZSAoRDoyMDE4MDEyNjE0MTQ0NSkKL1RpdGxlIChSIEdyYXBoaWNzIE91dHB1dCkKL1Byb2R1Y2VyIChSIDMuNC4xKQovQ3JlYXRvciAoUikKPj4KZW5kb2JqCjIgMCBvYmoKPDwgL1R5cGUgL0NhdGFsb2cgL1BhZ2VzIDMgMCBSID4+CmVuZG9iago3IDAgb2JqCjw8IC9UeXBlIC9QYWdlIC9QYXJlbnQgMyAwIFIgL0NvbnRlbnRzIDggMCBSIC9SZXNvdXJjZXMgNCAwIFIgPj4KZW5kb2JqCjggMCBvYmoKPDwKL0xlbmd0aCAyMDI0IC9GaWx0ZXIgL0ZsYXRlRGVjb2RlCj4+CnN0cmVhbQp4nJ1ZTXMbNxK981fgKB2M4Ptjj3Ylu+VKdpOIVXtwclBixpGLkrKisqn8+7xGYzANmlZEHSSxB8QM3sPr142RVW+VVR/V/zbf4eeLw/f/fK3eXG2MNsYo+fvqzb9xNUf1x+bdj8qo9xur3uLn48bSF9Q3mxx0MCp7HYK6VSEYbW0P9+rqaJijlLTjUZuiLn4M93AddzFrl8Z4D9dxH4pOdYz3cB2fljNWt46/3nbwPx9OgD/8fLf54isHpra/KOt0H+BfHGerTVIh6+jU9lZdmEu1/bj5ctvu/PRUG6u2cq47Y7KLRscqJoczJvuAP1ZMTmdMDr6RuU4uYzIAmaCscdpFsM2hr06n3Ng+Hre6jFCMQyQlreMcruMOjw7reA/Xce+w2jzGeyjGeUFjfF2fBC8QvxJEBKtzUrXo2vfsFHFPzrWQzLJnZ092IWjrec/Onuxt0pknl/Mnl0QBTbZHG96zaxPwIS/Jul/CgCVX7E//8lG4fPmqGdFz0tF3cYYjcbbYuaSrVyFVHSIt9t3Ft5fKG3Vx/Xizu3tUN+//oezlj2r79pl55i05li06855tb2536oeLf93//nD44fIMGvERuJ0p2gZe2df3HxRWF2h1D5dIBPw93Dzu1Jv73+8exyJBjJJkBUDFYjzr6GGn/qvupIVnIJe/n2vhASssBftojSUX7vF+Y/G9Utf46ugKZrhKvuxrxBNpRkzkwz4bAou4BPJdj72PFDtr6YMHrdgtxB4fsnLVa99iODRW5FImwSLGAFbk4FuWYu8sPc9B0KBgv5QBWw3lJeKc6HlUTjzFwXh6nvWVmEPsDT3P2rYsxLHQ80rR0TaAnREfaD2CEUyLhKfjLTDBIvCmoJ2VeA05jMDLVrXihWirwAu+2voG3qx9FHidp2kDrzNGJyPwZpRHL/BG36xz4MWfUFe81mTGPwDjObhwu8FGAlgPaXy6IAiBKThBCNadkhSA1d5IQoBbEoJ0bQR2QrwBgU4QUiwDWAhBHkQjCPGZBbYQQqlRBCHw9iAFAIKNJAQEZyMIcRBMkISEOgN2gRXbAQfsQJ4Ad0AL4OjoNgJw6QBXwCZIBdQjwJFuKwBbluhQQOaMWQAXr22UCiismKEAFFMJGIpObgJsqTUQO5x5gWKHqZqukq8skbHDkXdkAIZispQ8JGokYN96sVXyeEyWko+soAHYzoAheZ9nyTfCF8BYdvBS8pFTcM1xKBvdxKbAy+IS0vh0QRDSura99LwgPQCSz3WWfCNoEBJYkkMBhj1zEALCo1SAZ4CDkKpTkYS0uiwU4LS3swKSnxXQUnAooN1WekClBayAF5MYpocdnkyv7+AAbHkBw/QqAxAKCNLkc+ScFoDbDgjJNwADcO0psQDOnIILYDpDSJMPnsvWyHHLJi5dvuS57rnJ5fFAWdVQldj01qo253hXwABcewosgBMDFIDbjgjA3knAaD6sBJy4agzAkLzMcao6Se5w4Q1aAVua0CSf8xJ2ya8XJpdvOTkkj7JYpeQd7+AwvW4qwvRY4ovkUze5xeUhySIIASAjTQ+KctL0SFHSA0hR0vRIUZIQEJykAoCvmeAgBAuqk+TTUueNdmWNr46uiM6n0ERBSSAbFRqp3fZWF/BHGomTRgKLWthinTqB2DuhtRPwsvNZkmq4gOGkGbYY56QwlgsjEJ58B2DpdqOBXHSEltZInQTeB6ETTpS1HcxT4qQjnfR9F6T4o8Qxsh2MXfgjcUzvDlZrbN2IsMY8tUelF0NRHPNcHCsnzukXIwsNhpaFdEqtPeewpZO8MKVTmdLJsyGKklrrTFOMM01cUVaa0hFNTnaR6EG4KVoriJdNE0piPaogQRoqHT6kofrIPc6gyXHJn2myn9CEu5NacmlvLjhsSSgvTDTNhdYd2fCnnQf3kgtNrhfShabChwWRYo3mQZNl2IOmzK3eoAkwJhs2PYUWmnqzPmjyvQ6tanK105TgpzgbOTqjVdxV0tSOek/Q4Pk2IqnClFR5PmPBaZIov9508xs0LGewhYbEtI2k8lzuh/kaLu+i/AaZVDgDxanFtuw8V393tG9naNvP0Gr7oDI1VvgGf0BfRcmEWpL4NcSeDt/tm+ME/vnZ5M+obNBEjOfPtjineDohWzKU86fDqOjEDoUU+4LpOAWhqfdIEOzk2dOpf0BieKRpf+903nQ8FqWM0ie8gDoq5tg3OsqXF1DncKTHxrmIUlLOn05vGLxp5TK/gHnyFGycg+j8CxbvczuN0Sk0v4A6Olxi4yyogz+ePx2rxsZZ+NhJ7NKm1ywcPZIj27ndhOTaS1lqGLipbJ3JiH9Vvzzr3wb93S7vowWv8N5XsFBY+sNOfc4T57YjtZOADa6dyBQ5l13Cvfpc+emz0PSZsM7isP0P4uTq+yy0mkiaMYvD42d9MgsZhwtjFoc869TbOZ5VE+3aMomj9h8UQ913KdTgoXo2O8Yx35EpQxoQ5hLRXrze/u0/MtZ3nPxisv2mV1mQKhcJEstX+92HD2r3qK736svD483t9ePu5H8Jnrqdy+M97OtrfhH75yUcSV3sDuOu6pX6Zvf+5vru9HvZp+5vIxWv5T0vtHJxf3jcPVyqV8i7i5v7hxffmav9c1b+grvDEEp9ctlX17e/7Xdn3xiVwme+8Zvd3eH+Yfde/eenQ7s1Qfg/IMT2Mvx+XfV3m78AylKki2VuZHN0cmVhbQplbmRvYmoKMyAwIG9iago8PCAvVHlwZSAvUGFnZXMgL0tpZHMgWyA3IDAgUiBdIC9Db3VudCAxIC9NZWRpYUJveCBbMCAwIDUwNCA1MDRdID4+CmVuZG9iago0IDAgb2JqCjw8Ci9Qcm9jU2V0IFsvUERGIC9UZXh0XQovRm9udCA8PCAvRjEgMTAgMCBSIC9GMiAxMSAwIFIgL0YzIDEyIDAgUiA+PgovRXh0R1N0YXRlIDw8ID4+Ci9Db2xvclNwYWNlIDw8IC9zUkdCIDUgMCBSID4+Cj4+CmVuZG9iago1IDAgb2JqClsvSUNDQmFzZWQgNiAwIFJdCmVuZG9iago2IDAgb2JqCjw8IC9BbHRlcm5hdGUgL0RldmljZVJHQiAvTiAzIC9MZW5ndGggMjU5NiAvRmlsdGVyIC9GbGF0ZURlY29kZSA+PgpzdHJlYW0KeJydlndUU9kWh8+9N71QkhCKlNBraFICSA29SJEuKjEJEErAkAAiNkRUcERRkaYIMijggKNDkbEiioUBUbHrBBlE1HFwFBuWSWStGd+8ee/Nm98f935rn73P3Wfvfda6AJD8gwXCTFgJgAyhWBTh58WIjYtnYAcBDPAAA2wA4HCzs0IW+EYCmQJ82IxsmRP4F726DiD5+yrTP4zBAP+flLlZIjEAUJiM5/L42VwZF8k4PVecJbdPyZi2NE3OMErOIlmCMlaTc/IsW3z2mWUPOfMyhDwZy3PO4mXw5Nwn4405Er6MkWAZF+cI+LkyviZjg3RJhkDGb+SxGXxONgAoktwu5nNTZGwtY5IoMoIt43kA4EjJX/DSL1jMzxPLD8XOzFouEiSniBkmXFOGjZMTi+HPz03ni8XMMA43jSPiMdiZGVkc4XIAZs/8WRR5bRmyIjvYODk4MG0tbb4o1H9d/JuS93aWXoR/7hlEH/jD9ld+mQ0AsKZltdn6h21pFQBd6wFQu/2HzWAvAIqyvnUOfXEeunxeUsTiLGcrq9zcXEsBn2spL+jv+p8Of0NffM9Svt3v5WF485M4knQxQ143bmZ6pkTEyM7icPkM5p+H+B8H/nUeFhH8JL6IL5RFRMumTCBMlrVbyBOIBZlChkD4n5r4D8P+pNm5lona+BHQllgCpSEaQH4eACgqESAJe2Qr0O99C8ZHA/nNi9GZmJ37z4L+fVe4TP7IFiR/jmNHRDK4ElHO7Jr8WgI0IABFQAPqQBvoAxPABLbAEbgAD+ADAkEoiARxYDHgghSQAUQgFxSAtaAYlIKtYCeoBnWgETSDNnAYdIFj4DQ4By6By2AE3AFSMA6egCnwCsxAEISFyBAVUod0IEPIHLKFWJAb5AMFQxFQHJQIJUNCSAIVQOugUqgcqobqoWboW+godBq6AA1Dt6BRaBL6FXoHIzAJpsFasBFsBbNgTzgIjoQXwcnwMjgfLoK3wJVwA3wQ7oRPw5fgEVgKP4GnEYAQETqiizARFsJGQpF4JAkRIauQEqQCaUDakB6kH7mKSJGnyFsUBkVFMVBMlAvKHxWF4qKWoVahNqOqUQdQnag+1FXUKGoK9RFNRmuizdHO6AB0LDoZnYsuRlegm9Ad6LPoEfQ4+hUGg6FjjDGOGH9MHCYVswKzGbMb0445hRnGjGGmsVisOtYc64oNxXKwYmwxtgp7EHsSewU7jn2DI+J0cLY4X1w8TogrxFXgWnAncFdwE7gZvBLeEO+MD8Xz8MvxZfhGfA9+CD+OnyEoE4wJroRIQiphLaGS0EY4S7hLeEEkEvWITsRwooC4hlhJPEQ8TxwlviVRSGYkNimBJCFtIe0nnSLdIr0gk8lGZA9yPFlM3kJuJp8h3ye/UaAqWCoEKPAUVivUKHQqXFF4pohXNFT0VFysmK9YoXhEcUjxqRJeyUiJrcRRWqVUo3RU6YbStDJV2UY5VDlDebNyi/IF5UcULMWI4kPhUYoo+yhnKGNUhKpPZVO51HXURupZ6jgNQzOmBdBSaaW0b2iDtCkVioqdSrRKnkqNynEVKR2hG9ED6On0Mvph+nX6O1UtVU9Vvuom1TbVK6qv1eaoeajx1UrU2tVG1N6pM9R91NPUt6l3qd/TQGmYaYRr5Grs0Tir8XQObY7LHO6ckjmH59zWhDXNNCM0V2ju0xzQnNbS1vLTytKq0jqj9VSbru2hnaq9Q/uE9qQOVcdNR6CzQ+ekzmOGCsOTkc6oZPQxpnQ1df11Jbr1uoO6M3rGelF6hXrtevf0Cfos/ST9Hfq9+lMGOgYhBgUGrQa3DfGGLMMUw12G/YavjYyNYow2GHUZPTJWMw4wzjduNb5rQjZxN1lm0mByzRRjyjJNM91tetkMNrM3SzGrMRsyh80dzAXmu82HLdAWThZCiwaLG0wS05OZw2xljlrSLYMtCy27LJ9ZGVjFW22z6rf6aG1vnW7daH3HhmITaFNo02Pzq62ZLde2xvbaXPJc37mr53bPfW5nbse322N3055qH2K/wb7X/oODo4PIoc1h0tHAMdGx1vEGi8YKY21mnXdCO3k5rXY65vTW2cFZ7HzY+RcXpkuaS4vLo3nG8/jzGueNueq5clzrXaVuDLdEt71uUnddd457g/sDD30PnkeTx4SnqWeq50HPZ17WXiKvDq/XbGf2SvYpb8Tbz7vEe9CH4hPlU+1z31fPN9m31XfKz95vhd8pf7R/kP82/xsBWgHcgOaAqUDHwJWBfUGkoAVB1UEPgs2CRcE9IXBIYMj2kLvzDecL53eFgtCA0O2h98KMw5aFfR+OCQ8Lrwl/GGETURDRv4C6YMmClgWvIr0iyyLvRJlESaJ6oxWjE6Kbo1/HeMeUx0hjrWJXxl6K04gTxHXHY+Oj45vipxf6LNy5cDzBPqE44foi40V5iy4s1licvvj4EsUlnCVHEtGJMYktie85oZwGzvTSgKW1S6e4bO4u7hOeB28Hb5Lvyi/nTyS5JpUnPUp2Td6ePJninlKR8lTAFlQLnqf6p9alvk4LTduf9ik9Jr09A5eRmHFUSBGmCfsytTPzMoezzLOKs6TLnJftXDYlChI1ZUPZi7K7xTTZz9SAxESyXjKa45ZTk/MmNzr3SJ5ynjBvYLnZ8k3LJ/J9879egVrBXdFboFuwtmB0pefK+lXQqqWrelfrry5aPb7Gb82BtYS1aWt/KLQuLC98uS5mXU+RVtGaorH1futbixWKRcU3NrhsqNuI2ijYOLhp7qaqTR9LeCUXS61LK0rfb+ZuvviVzVeVX33akrRlsMyhbM9WzFbh1uvb3LcdKFcuzy8f2x6yvXMHY0fJjpc7l+y8UGFXUbeLsEuyS1oZXNldZVC1tep9dUr1SI1XTXutZu2m2te7ebuv7PHY01anVVda926vYO/Ner/6zgajhop9mH05+x42Rjf2f836urlJo6m06cN+4X7pgYgDfc2Ozc0tmi1lrXCrpHXyYMLBy994f9Pdxmyrb6e3lx4ChySHHn+b+O31w0GHe4+wjrR9Z/hdbQe1o6QT6lzeOdWV0iXtjusePhp4tLfHpafje8vv9x/TPVZzXOV42QnCiaITn07mn5w+lXXq6enk02O9S3rvnIk9c60vvG/wbNDZ8+d8z53p9+w/ed71/LELzheOXmRd7LrkcKlzwH6g4wf7HzoGHQY7hxyHui87Xe4Znjd84or7ldNXva+euxZw7dLI/JHh61HXb95IuCG9ybv56Fb6ree3c27P3FlzF3235J7SvYr7mvcbfjT9sV3qID0+6j068GDBgztj3LEnP2X/9H686CH5YcWEzkTzI9tHxyZ9Jy8/Xvh4/EnWk5mnxT8r/1z7zOTZd794/DIwFTs1/lz0/NOvm1+ov9j/0u5l73TY9P1XGa9mXpe8UX9z4C3rbf+7mHcTM7nvse8rP5h+6PkY9PHup4xPn34D94Tz+2VuZHN0cmVhbQplbmRvYmoKOSAwIG9iago8PAovVHlwZSAvRW5jb2RpbmcgL0Jhc2VFbmNvZGluZyAvV2luQW5zaUVuY29kaW5nCi9EaWZmZXJlbmNlcyBbIDQ1L21pbnVzIF0KPj4KZW5kb2JqCjEwIDAgb2JqCjw8IC9UeXBlIC9Gb250IC9TdWJ0eXBlIC9UeXBlMSAvTmFtZSAvRjEgL0Jhc2VGb250IC9aYXBmRGluZ2JhdHMgPj4KZW5kb2JqCjExIDAgb2JqCjw8IC9UeXBlIC9Gb250IC9TdWJ0eXBlIC9UeXBlMSAvTmFtZSAvRjIgL0Jhc2VGb250IC9IZWx2ZXRpY2EKL0VuY29kaW5nIDkgMCBSID4+CmVuZG9iagoxMiAwIG9iago8PCAvVHlwZSAvRm9udCAvU3VidHlwZSAvVHlwZTEgL05hbWUgL0YzIC9CYXNlRm9udCAvSGVsdmV0aWNhLUJvbGQKL0VuY29kaW5nIDkgMCBSID4+CmVuZG9iagp4cmVmCjAgMTMKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDIxIDAwMDAwIG4gCjAwMDAwMDAxNjMgMDAwMDAgbiAKMDAwMDAwMjM4OCAwMDAwMCBuIAowMDAwMDAyNDcxIDAwMDAwIG4gCjAwMDAwMDI2MDYgMDAwMDAgbiAKMDAwMDAwMjYzOSAwMDAwMCBuIAowMDAwMDAwMjEyIDAwMDAwIG4gCjAwMDAwMDAyOTIgMDAwMDAgbiAKMDAwMDAwNTMzNCAwMDAwMCBuIAowMDAwMDA1NDI4IDAwMDAwIG4gCjAwMDAwMDU1MTIgMDAwMDAgbiAKMDAwMDAwNTYwOSAwMDAwMCBuIAp0cmFpbGVyCjw8IC9TaXplIDEzIC9JbmZvIDEgMCBSIC9Sb290IDIgMCBSID4+CnN0YXJ0eHJlZgo1NzExCiUlRU9GCg==" style="display: block; margin: auto;" type="application/pdf"></embed>
<p>Whereas the following figure shows patient 81 who is identified as having a lag phase before the decay occurs.</p>
<embed src="data:application/pdf;base64,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IF0KPj4KZW5kb2JqCjEwIDAgb2JqCjw8IC9UeXBlIC9Gb250IC9TdWJ0eXBlIC9UeXBlMSAvTmFtZSAvRjEgL0Jhc2VGb250IC9aYXBmRGluZ2JhdHMgPj4KZW5kb2JqCjExIDAgb2JqCjw8IC9UeXBlIC9Gb250IC9TdWJ0eXBlIC9UeXBlMSAvTmFtZSAvRjIgL0Jhc2VGb250IC9IZWx2ZXRpY2EKL0VuY29kaW5nIDkgMCBSID4+CmVuZG9iagoxMiAwIG9iago8PCAvVHlwZSAvRm9udCAvU3VidHlwZSAvVHlwZTEgL05hbWUgL0YzIC9CYXNlRm9udCAvSGVsdmV0aWNhLUJvbGQKL0VuY29kaW5nIDkgMCBSID4+CmVuZG9iagp4cmVmCjAgMTMKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDIxIDAwMDAwIG4gCjAwMDAwMDAxNjMgMDAwMDAgbiAKMDAwMDAwMjM3MyAwMDAwMCBuIAowMDAwMDAyNDU2IDAwMDAwIG4gCjAwMDAwMDI1OTEgMDAwMDAgbiAKMDAwMDAwMjYyNCAwMDAwMCBuIAowMDAwMDAwMjEyIDAwMDAwIG4gCjAwMDAwMDAyOTIgMDAwMDAgbiAKMDAwMDAwNTMxOSAwMDAwMCBuIAowMDAwMDA1NDEzIDAwMDAwIG4gCjAwMDAwMDU0OTcgMDAwMDAgbiAKMDAwMDAwNTU5NCAwMDAwMCBuIAp0cmFpbGVyCjw8IC9TaXplIDEzIC9JbmZvIDEgMCBSIC9Sb290IDIgMCBSID4+CnN0YXJ0eHJlZgo1Njk2CiUlRU9GCg==" style="display: block; margin: auto;" type="application/pdf"></embed>
<p>By using the following commands, we can calculate the posterior mean, median, and 95% credible interval of each individual’s clearance rate<a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a>. (Or we can pick several specific indivdiuals by using a vector of IDs.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Example: Patient 1, 3, 14, 35</span>
id &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">14</span>, <span class="dv">35</span>)
a &lt;-<span class="st"> </span>.<span class="dv">025</span>
results$clearance.mean[id]
[<span class="dv">1</span>] <span class="fl">0.10762175</span> <span class="fl">0.08054074</span> <span class="fl">0.08373204</span> <span class="fl">0.11575772</span>

results$clearance.median[id]
[<span class="dv">1</span>] <span class="fl">0.10802284</span> <span class="fl">0.08176813</span> <span class="fl">0.08487102</span> <span class="fl">0.11725616</span>

<span class="co"># If we want to check several patient's profiles simultaneously</span>
CI &lt;-<span class="st"> </span><span class="kw">apply</span>(results$clearance.post[id, ], <span class="dv">1</span>, quantile, <span class="dt">probs=</span><span class="kw">c</span>(a, <span class="dv">1</span>-a))
<span class="kw">colnames</span>(CI) &lt;-<span class="st"> </span>id
CI
               <span class="dv">1</span>          <span class="dv">3</span>         <span class="dv">14</span>        <span class="dv">35</span>
<span class="fl">2.5</span>%  <span class="fl">0.1005186</span> <span class="fl">0.07273923</span> <span class="fl">0.07624411</span> <span class="fl">0.09641293</span>
<span class="fl">97.5</span>% <span class="fl">0.1167284</span> <span class="fl">0.08816739</span> <span class="fl">0.08975329</span> <span class="fl">0.13476679</span>

<span class="co"># If we want to check only one patient's CI, for example patient id = 1</span>
id &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="kw">quantile</span>(results$clearance.post[id, ], <span class="kw">c</span>(a, <span class="dv">1</span>-a))
     <span class="fl">2.5</span>%     97.5%<span class="st"> </span>
<span class="fl">0.1005186</span> <span class="fl">0.1167284</span> </code></pre></div>
<p>For the patient with id <span class="math inline">\(1\)</span>, the posterior mean clearance rate was <span class="math inline">\(0.1076\)</span>, the median was <span class="math inline">\(0.1080\)</span> with a 95% credible interval of <span class="math inline">\([0.1005, 0.1167]\)</span>. For patient <span class="math inline">\(1\)</span>, we now check the posterior distribution of the time of changepoint between lag and decay phases by using the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Here we focus on patient with id 1</span>
<span class="co"># The output is a vector of posterior samples of changepoint time</span>
<span class="co"># We display it in two rows here</span>
results$changelag.post[id, ]
[<span class="dv">1</span>] <span class="fl">0.000000</span> <span class="fl">0.000000</span> <span class="fl">10.036735</span> <span class="fl">1.831670</span> <span class="fl">0.000000</span>   
[<span class="dv">5</span>] <span class="fl">4.633040</span> <span class="fl">1.847377</span> <span class="fl">0.000000</span>  <span class="fl">0.000000</span> <span class="fl">7.982357</span></code></pre></div>
<p>There are 10 posterior samples in total after thinning. We can see that only 20% of the posterior samples identified this individual as having a lag phase of more than 6 hours, and only 30% identified a lag phase of more than 3 hours. Again, our analysis here is based on our previous fast example which has a small number of total iterations. So the posterior results are only used for tutorial purpose. For the real data set, the percentage results may be very different.</p>
<p>For the patient with id 81, the posterior mean clearance rate was <span class="math inline">\(0.1284\)</span>, the median was <span class="math inline">\(0.1270\)</span> with a 95% credible interval of <span class="math inline">\([0.1196, 0.1423]\)</span>. There are 100% posterior of samples identifying this individual as having a lag phase of greater than 6 hours, whereas no samples identified a tail phase, as shown by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># id &lt;- 81</span>
results$changetail.post[id, ]
[<span class="dv">1</span>] <span class="dv">84</span> <span class="dv">84</span> <span class="dv">84</span> <span class="dv">84</span> <span class="dv">84</span> <span class="dv">84</span> <span class="dv">84</span> <span class="dv">84</span> <span class="dv">84</span> <span class="dv">84</span></code></pre></div>
<p>which implies that we didn’t observe a tail phase in any posterior sample until the end (maximum observation time) of our experiment. The posterior median of the time of changepoint between lag and decay phases for this individual is 24.86 (hours), which can be obtained by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results$lag.median[id]
[<span class="dv">1</span>] <span class="fl">24.8569</span></code></pre></div>
<p>The 95% credible interval for the time of changepoint between lag and decay phases is <span class="math inline">\([8.337287, 28.843629]\)</span> (this results is only for tutorial purpose), which can be obtained by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>(results$changelag.post[id, ], <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))
    <span class="fl">2.5</span>%     97.5%<span class="st"> </span>
<span class="fl">8.337287</span> <span class="fl">28.843629</span> </code></pre></div>
<p>For a detailed discussion of the plots and the difference among three different posterior curves produced by the <code>plot</code> function, please see our JSS paper.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-amaratunga">
<p>Amaratunga, C., Sreng, S., Suon, S., Phelps, E.S., Stepniewska, K., Lim, P., and al., 2012. Artemisinin-resistant <em>plasmodium falciparum</em> in pursat province, western cambodia: A parasite clearance rate study.</p>
</div>
<div id="ref-ashley">
<p>Ashley, E.A., Dhorda, M., Fairhurst, R.M., Amaratunga, C., Lim, P., Suon, S., and al., 2014. Spread of artemisinin resistance in plasmodium falciparum malaria.</p>
</div>
<div id="ref-cowles">
<p>Cowles, M.K. and Carlin, B.P., 1996. Markov chain monte carlo convergence diagnostics: A comparative review. <em>Journal of the American Statistical Association</em>, 91 (434), 883–904.</p>
</div>
<div id="ref-doolan">
<p>Doolan, D.L., 2002. Malaria methods and protocols.</p>
</div>
<div id="ref-dowling">
<p>Dowling, M. and Shute, G., 1966. A comparative study of thick and thin blood films in the diagnosis of scanty malaria parasitaemia.</p>
</div>
<div id="ref-flegg">
<p>Flegg, J., Guerin, P., White, N., and Stepniewska, K., 2011. Standardizing the measurement of parasite clearance in <em>falciparum</em> malaria: The parasite clearance estimator.</p>
</div>
<div id="ref-fogarty">
<p>Fogarty, C.B., Fay, M.P., Flegg, J.A., Stepniewska, K., Fairhurst, R.M., and Small, D.S., 2015. Bayesian heirarchical regression on clearance rates in the presence of ‘lag’ and ‘tail’ phases with an application to malaria parasites.</p>
</div>
<div id="ref-gelman2011">
<p>Gelman, A. and Shirley, K., 2011. Inference from simulations and monitoring convergence. <em>Handbook of markov chain monte carlo</em>, 163–174.</p>
</div>
<div id="ref-koning">
<p>Koning, L.O., 2007. Progress in malaria research.</p>
</div>
<div id="ref-omeara">
<p>O’Meara, W.P., McKenzie, F.E., Magill, A.J., Forney, J.R., Permpanich, B., Lucas, C., Gasser Jr, R.A., and Wongsrichanalai, C., 2005. Sources of variability in determining malaria parasite density by microscopy.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>contributed equally to this work<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Note that this method allows uneven measurement times.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p><span class="math inline">\({\mathbb{1}}_A\)</span> is the indicator function of <span class="math inline">\(A\)</span> which takes the value one if <span class="math inline">\(A\)</span> occurs, and zero otherwise.<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p><span class="math inline">\({\mathcal{N}}(\mu, \sigma^2)\)</span> represents the normal distribution with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>.<a href="#fnref4">↩</a></p></li>
<li id="fn5"><p>It may take a while to run the code, depending on your computer’s hardware. Here we only use a small number of iterations for tutorial purpose.<a href="#fnref5">↩</a></p></li>
<li id="fn6"><p>For those who may not be very familiar with Gibbs sampling: In statistics, Gibbs sampling or a Gibbs sampler is a conditional sampling technique for obtaining a sequence of observations which are approximately from a specified multivariate probability distribution, when direct sampling is difficult. This method is frequently used in Bayesian statistics. Usually we need to set a “burn-in” period for our MCMC algorithm and to discard the first <span class="math inline">\(m\)</span> samples. The idea is that a “bad” starting point may over-sample regions that have very low probability under the equilibrium distribution before it converges to the equilibrium distribution. So we need to give the Markov chain time to reach its equilibrium. Furthermore, Gibbs sampling generates a Markov chain of samples, each of which is correlated with nearby samples. Thus if uncorrelated samples are required for the model, we may thin the resulting chain (after the burn-in period) by only taking every <span class="math inline">\(n\)</span>-th value, which is called “thinning”.<a href="#fnref6">↩</a></p></li>
<li id="fn7"><p>We still use the fast example with <code>seed = 1234</code> for reproducibility.<a href="#fnref7">↩</a></p></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
